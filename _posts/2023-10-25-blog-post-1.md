---
title: "Alexnet input 224？227"
date: 2023-10-25
permalink: /posts/2023/10/blog-post-1/
collection: posts
toc: true
tags:
  - Alexnet
  - 探究细节
---
## 0.结论 

> 


## 1.问题
<img src="https://raw.githubusercontent.com/CastleDream/CastleDream.github.io/master/images/2023-10-25/1_2_Alexnet.png" width="70%"/>

在Alexnet的论文中，结构图上给的输入是224，但是如果按照224去计算，得到的下一次的输出不是55，即：
$$
\begin{aligned}
(224-11)/4+1&=&54.25 \\
(227-11)/4+1&=&55
\end{aligned}
$$

而Alexnet训练时的数据处理步骤为：
1. 下采样得到$256\times 256$的图像
2. 从256的图像中crop出224的图像

> 因此有人认为，在真正送入网络之前，可能加了3个像素的padding，得到227
## 2. 解决问题

### 2.1 文字描述
<img src="https://raw.githubusercontent.com/CastleDream/CastleDream.github.io/master/images/2023-10-25/1_1_wiki.png" width="70%"/>

类似的言论在[cs231的资料中](https://cs231n.github.io/convolutional-networks/)也有提及
> The Krizhevsky et al. architecture that won the ImageNet challenge in 2012 accepted images of size [227x227x3]

### 2.2 代码层面
在AlexNet的[Caffe实现](https://github.com/BVLC/caffe/blob/master/models/bvlc_alexnet/train_val.prototxt)中，可以看到**使用的图像尺寸其实是227**
```bash
name: "AlexNet"
layer {
  name: "data"
  type: "Data"
  top: "data"
  top: "label"
  include {
    phase: TRAIN
  }
  transform_param {
    mirror: true
    crop_size: 227
```

不过，在[pytorch](https://pytorch.org/vision/main/_modules/torchvision/models/alexnet.html)或者是[mmpretrain](https://github.com/open-mmlab/mmpretrain/blob/main/mmpretrain/models/backbones/alexnet.py)的Alexnet实现中，**使用的都是224**
```python
# pytorch
[docs]class AlexNet_Weights(WeightsEnum):
    IMAGENET1K_V1 = Weights(
        url="https://download.pytorch.org/models/alexnet-owt-7be5be79.pth",
        transforms=partial(ImageClassification, crop_size=224),

# mmpretrain
@MODELS.register_module()
class AlexNet(BaseBackbone):
    """`AlexNet <https://en.wikipedia.org/wiki/AlexNet>`_ backbone.

    The input for AlexNet is a 224x224 RGB image.

    Args:
        num_classes (int): number of classes for classification.
            The default value is -1, which uses the backbone as
            a feature extractor without the top classifier.
    """
```
## 2.3 手动计算比较




### 🔗参考资料：
+ [What is the input size of Alex net](https://datascience.stackexchange.com/questions/29245/what-is-the-input-size-of-alex-net)
+ [WiKi-pedia Alexnet](https://en.wikipedia.org/wiki/AlexNet)
+ <https://cs231n.github.io/convolutional-networks/>
+ <https://github.com/BVLC/caffe/blob/master/models/bvlc_alexnet/train_val.prototxt>

